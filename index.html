<script>

/* PARTICLES */
particlesJS("particles-js",{
 particles:{
  number:{value:80},
  color:{value:"#facc15"},
  size:{value:3},
  move:{enable:true,speed:2}
 }
});

/* SOUND TOGGLE */
const bannerVideo=document.getElementById('bannerVideo');
const soundBtn=document.getElementById('soundToggle');

soundBtn.addEventListener('click',()=>{

 if(bannerVideo.muted){
   bannerVideo.muted=false;
   bannerVideo.play();
   soundBtn.innerText='ðŸ”‡ Tap to Mute';
 }
 else{
   bannerVideo.muted=true;
   soundBtn.innerText='ðŸ”Š Tap for Sound';
 }

});

/* PAUSE VIDEO ON SCROLL */
const bannerSection=document.querySelector('.banner');

window.addEventListener('scroll',()=>{
 const rect=bannerSection.getBoundingClientRect();

 if(rect.bottom<=0 || rect.top>=window.innerHeight){
   bannerVideo.pause();
 }else{
   if(bannerVideo.paused){
     bannerVideo.play();
   }
 }
});

/* IMAGE VALIDATION â€” EXACT 6 */
document.getElementById('images').addEventListener('change',function(){
 if(this.files.length!==6){
  alert('Please upload exactly 6 photos');
  this.value='';
 }
});

/* DEMO AUTOMATION FLOW */
const form=document.getElementById('propertyForm');
const timeEl=document.getElementById('time');
const linkBox=document.getElementById('linkBox');
const demoLink=document.getElementById('demoLink');
const preview=document.getElementById('demoPreview');
const previewBox=document.getElementById('previewBox');
const demoLines=document.getElementById('demoLines');
const waitVideo=document.getElementById('demoWaitVideo');

const lines=[
 'This is a demo web page we can customise to your idea',
 'Webpage with subject & header photo will be sent to customers',
 'This webpage will be converted into video',
 'Title, description & hashtags generated automatically',
 'Auto posting to all social media',
 'Automatic WhatsApp chatbot follow-up',
 'All created at zero cost'
];

form.addEventListener('submit',function(){

 /* Validate images again */
 if(document.getElementById('images').files.length!==6){
   alert('Upload exactly 6 photos to continue');
   return false;
 }

 /* Show countdown */
 document.getElementById('countdownBox').style.display='block';

 /* Restart wait video */
 if(waitVideo){
   waitVideo.currentTime=0;
   waitVideo.play();
 }

 /* Rotate persuasion lines */
 let lineIndex=0;
 setInterval(()=>{
   lineIndex=(lineIndex+1)%lines.length;
   demoLines.innerText=lines[lineIndex];
 },4000);

 /* TIMER */
 let t=150;
 const timer=setInterval(()=>{
   t--;
   timeEl.innerText=t;

   if(t<=0){
     clearInterval(timer);

     /* GET FORM VALUES */
     const id=form.id.value||'101';
     const title=form.title.value||'';
     const location=form.location.value||'';

     /* SLUG FUNCTION */
     function slugify(text){
       return text
        .toLowerCase()
        .trim()
        .replace(/[^a-z0-9 ]/g,'')
        .replace(/\s+/g,'-');
     }

     const slug=
       slugify(title)+'-'+
       slugify(location)+'-'+
       id+'.html';

     const link=
     'https://britsingh20-source.github.io/2-bhk-idigarai-45-lakhs/property/'+slug;

     /* SHOW LINK */
     demoLink.href=link;
     demoLink.innerText=link;
     linkBox.style.display='block';

     /* LOAD PREVIEW */
     preview.src=link;
     previewBox.style.display='block';
   }

 },1000);

});

</script>
